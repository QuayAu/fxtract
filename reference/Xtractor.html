<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>R6 Object for Feature Extraction. — Xtractor • fxtract</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="R6 Object for Feature Extraction. — Xtractor" />
<meta property="og:description" content="Xtractor calculates features from raw data for each ID of a grouping variable individually. This process can be parallelized with the package future." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fxtract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Xtractor
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial/xtractor_basics.html">Basics</a>
    </li>
    <li>
      <a href="../articles/tutorial/xtractor_preprocess_data.html">Preprocess Data</a>
    </li>
    <li>
      <a href="../articles/tutorial/xtractor_update_data.html">Update Data</a>
    </li>
    <li>
      <a href="../articles/tutorial/xtractor_update_feature.html">Update Feature</a>
    </li>
    <li>
      <a href="../articles/tutorial/xtractor_error_handling.html">Error Handling</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/QuayAu/fxtract/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>R6 Object for Feature Extraction.</h1>
    <small class="dont-index">Source: <a href='https://github.com/QuayAu/fxtract/blob/master/R/xtractor.R'><code>R/xtractor.R</code></a></small>
    <div class="hidden name"><code>Xtractor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>Xtractor</code> calculates features from raw data for each ID of a grouping variable individually. This process can be parallelized with the package future.</p>
    </div>



    <h2 class="hasAnchor" id="format"><a class="anchor" href="#format"></a>Format</h2>

    <p><code>R6Class</code> object.</p>
    <h2 class="hasAnchor" id="usage"><a class="anchor" href="#usage"></a>Usage</h2>

    

<pre>
<span class='no'>xtractor</span> <span class='kw'>=</span> <span class='no'>Xtractor</span>$<span class='fu'>new</span>(<span class='st'>"xtractor"</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>

    


<p>For Xtractor$new():</p><dl'>
<dt><code>name</code>: </dt><dd><p>(`character(1)`): A user defined name of the Xtractor. All necessary data will be saved on the path: ./fxtract_files/name/</p></dd>
<dt><code>load</code>: </dt><dd><p>(`logical(1)`): If TRUE, an existing Xtractor will be loaded.</p></dd>
<dt><code>file.dir</code>: </dt><dd><p>(`character(1)`): Path where all files of the Xtractor are saved. Default is the current working directory.</p></dd>

</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>All datasets and feature functions are saved in this R6 object.
Datasets will be saved as single RDS files (for each ID) and feature functions are calculated on each single dataset.
A big advantage of this method is that it scales nicely for larger datasets. Data is only read into RAM, when needed.</p>
    <h2 class="hasAnchor" id="fields"><a class="anchor" href="#fields"></a>Fields</h2>

    

<dl'>
<dt><code>error_messages</code>: </dt><dd><p>(`data.frame()`): Active binding. A dataframe with information about error messages.</p></dd>
<dt><code>ids</code>: </dt><dd><p>(`character()`): Active binding. A character vector with the IDs of the grouping variable.</p></dd>
<dt><code>features</code>: </dt><dd><p>(`character()`): Active binding. A character vector with the feature functions which were added.</p></dd>
<dt><code>status</code>: </dt><dd><p>(`data.frame()`): Active binding. A dataframe with an overview over which features are calculated on which datasets.</p></dd>
<dt><code>results</code>: </dt><dd><p>(`data.frame()`): Active binding. A dataframe with all calculated features of all IDs.</p></dd>

</dl>

    <h2 class="hasAnchor" id="methods"><a class="anchor" href="#methods"></a>Methods</h2>

    

<dl'>
<dt><code>add_data(data, group_by)</code></dt><dd><p>[data: (`data.frame` | `data.table`)] A dataframe or data.table which shall be added to the R6 object. <br />
 [group_by: (`character(1)`)] The grouping variable's name of the dataframe. <br /> <br />
 This method writes single RDS files for each group.</p></dd>
<dt><code>preprocess_data(fun)</code></dt><dd><p>[fun: (`function`)] A function, which has a dataframe as input and a dataframe as output. <br /> <br />
 This method loads the RDS files and applies this function on them. The old RDS files are overwritten.</p></dd>
<dt><code>remove_data(ids)</code></dt><dd><p>[ids: (`character()`)] One or many IDs of the grouping variable. <br /> <br />
 This method deletes the RDS files of the given IDs.</p></dd>
<dt><code>get_data(ids)</code></dt><dd><p>[ids: (`character()`)] One or many IDs of the grouping variable. <br /> <br />
 This method returns one dataframe with the chosen IDs.</p></dd>
<dt><code>add_feature(fun, check_fun)</code></dt><dd><p>[fun: (`function`)] A function, which has a dataframe as input and a named vector or list as output. <br />
 [check_fun: (`logical(1)`)] The function will be checked if it returns a vector or a  list. Defaults to <code>TRUE</code>. Disable, if calculation takes too long. <br /> <br />
 This method adds the feature function to the R6 object. It writes an RDS file of the function which can be retrieved later.</p></dd>
<dt><code>remove_feature(fun)</code></dt><dd><p>[fun: (`function | character(1)`)] A function (or the name of the function as character) which shall be removed. <br /> <br />
 This method removes the function from the object and deletes all corresponding files and results.</p></dd>
<dt><code>get_feature(fun)</code></dt><dd><p>[fun: (`character(1)`)] The name of a function as character. <br /> <br />
 This method reads the RDS file of the function. Useful for debugging after loading an Xtractor.</p></dd>
<dt><code>calc_features(features, ids)</code></dt><dd><p>[features: (`character()`)] A character vector of the names of the features which shall be calculated. Defaults to all features. <br />
[ids: (`character()`)] One or many IDs of the grouping variable. Defaults to all IDs. <br /> <br />
This method calculates all features on the chosen IDs.</p></dd>
<dt><code>retry_failed_features(features)</code></dt><dd><p>[features: (`character()`)] A character vector of the names of the features which shall be calculated. Defaults to all features. <br /> <br />
This method retries calculation of failed features. Useful if calculation failed because of memory problems.</p></dd>
<dt><code><a href='https://rdrr.io/r/base/plot.html'>plot()</a></code></dt><dd><p>[internal] method to print the R6 object.</p></dd>
<dt><code>clone()</code></dt><dd><p>[internal] method to clone the R6 object.</p></dd>
<dt><code>initialize()</code></dt><dd><p>[internal] method to initialize the R6 object.</p></dd>

</dl>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># one feature function</span>
<span class='no'>dir</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempdir</a></span>()
<span class='no'>xtractor</span> <span class='kw'>=</span> <span class='no'>Xtractor</span>$<span class='fu'>new</span>(<span class='st'>"xtractor"</span>, <span class='kw'>file.dir</span> <span class='kw'>=</span> <span class='no'>dir</span>)
<span class='no'>xtractor</span>$<span class='fu'>add_data</span>(<span class='no'>iris</span>, <span class='kw'>group_by</span> <span class='kw'>=</span> <span class='st'>"Species"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: `distinct_()` is deprecated as of dplyr 0.7.0.</span>
#&gt; <span class='warning'>Please use `distinct()` instead.</span>
#&gt; <span class='warning'>See vignette('programming') for more help</span>
#&gt; <span class='warning'>This warning is displayed once every 8 hours.</span>
#&gt; <span class='warning'>Call `lifecycle::last_warnings()` to see where this warning was generated.</span></div><div class='output co'>#&gt; <span class='message'>Saving raw RDS files.</span></div><div class='output co'>#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=======================                                               |  33%  |                                                                              |===============================================                       |  67%  |                                                                              |======================================================================| 100%</div><div class='input'><span class='no'>xtractor</span>$<span class='no'>ids</span></div><div class='output co'>#&gt; [1] "setosa"     "versicolor" "virginica" </div><div class='input'><span class='no'>fun</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>data</span>) {
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>mean_sepal_length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>data</span>$<span class='no'>Sepal.Length</span>))
}
<span class='no'>xtractor</span>$<span class='fu'>add_feature</span>(<span class='no'>fun</span>)
<span class='no'>xtractor</span>$<span class='no'>features</span></div><div class='output co'>#&gt; [1] "fun"</div><div class='input'><span class='no'>xtractor</span>$<span class='fu'>calc_features</span>()</div><div class='output co'>#&gt; <span class='message'>Calculating features on 1 core(s).</span></div><div class='output co'>#&gt; <span class='message'>Calculating feature function: fun</span></div><div class='input'><span class='no'>xtractor</span>$<span class='no'>results</span></div><div class='output co'>#&gt;      Species mean_sepal_length
#&gt; 1     setosa             5.006
#&gt; 2 versicolor             5.936
#&gt; 3  virginica             6.588</div><div class='input'><span class='no'>xtractor</span>$<span class='no'>status</span></div><div class='output co'>#&gt;      Species  fun
#&gt; 1     setosa done
#&gt; 2 versicolor done
#&gt; 3  virginica done</div><div class='input'><span class='no'>xtractor</span></div><div class='output co'>#&gt; R6 Object: Xtractor
#&gt; Name: xtractor
#&gt; Grouping variable: Species
#&gt; IDs: setosa, versicolor, virginica
#&gt; Feature functions: fun
#&gt; Extraction done: 100%
#&gt; Errors during calculation: 0 </div><div class='input'>
<span class='co'># failing function on only one ID</span>
<span class='no'>fun2</span> <span class='kw'>=</span> <span class='kw'>function</span>(<span class='no'>data</span>) {
  <span class='kw'>if</span> (<span class='st'>"setosa"</span> <span class='kw'>%in%</span> <span class='no'>data</span>$<span class='no'>Species</span>) <span class='fu'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span>(<span class='st'>"my error"</span>)
  <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>sd_sepal_length</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span>(<span class='no'>data</span>$<span class='no'>Sepal.Length</span>))
}
<span class='no'>xtractor</span>$<span class='fu'>add_feature</span>(<span class='no'>fun2</span>)
<span class='no'>xtractor</span>$<span class='fu'>calc_features</span>()</div><div class='output co'>#&gt; <span class='message'>Feature function 'fun' was already applied on every ID and will be skipped.</span></div><div class='output co'>#&gt; <span class='message'>Calculating features on 1 core(s).</span></div><div class='output co'>#&gt; <span class='message'>Calculating feature function: fun2</span></div><div class='input'><span class='no'>xtractor</span>$<span class='no'>results</span></div><div class='output co'>#&gt;      Species mean_sepal_length sd_sepal_length
#&gt; 1     setosa             5.006              NA
#&gt; 2 versicolor             5.936       0.5161711
#&gt; 3  virginica             6.588       0.6358796</div><div class='input'><span class='no'>xtractor</span>$<span class='no'>error_messages</span></div><div class='output co'>#&gt;   feature_function     id error_message
#&gt; 1             fun2 setosa      my error</div><div class='input'><span class='no'>xtractor</span></div><div class='output co'>#&gt; R6 Object: Xtractor
#&gt; Name: xtractor
#&gt; Grouping variable: Species
#&gt; IDs: setosa, versicolor, virginica
#&gt; Feature functions: fun, fun2
#&gt; Extraction done: 83.3333333333333%
#&gt; Errors during calculation: 1 </div><div class='input'>
<span class='co'># remove feature function</span>
<span class='no'>xtractor</span>$<span class='fu'>remove_feature</span>(<span class='st'>"fun2"</span>)
<span class='no'>xtractor</span>$<span class='no'>results</span></div><div class='output co'>#&gt;      Species mean_sepal_length
#&gt; 1     setosa             5.006
#&gt; 2 versicolor             5.936
#&gt; 3  virginica             6.588</div><div class='input'><span class='no'>xtractor</span></div><div class='output co'>#&gt; R6 Object: Xtractor
#&gt; Name: xtractor
#&gt; Grouping variable: Species
#&gt; IDs: setosa, versicolor, virginica
#&gt; Feature functions: fun
#&gt; Extraction done: 100%
#&gt; Errors during calculation: 0 </div><div class='input'>
<span class='co'># remove ID</span>
<span class='no'>xtractor</span>$<span class='fu'>remove_data</span>(<span class='st'>"setosa"</span>)</div><div class='output co'>#&gt; <span class='message'>Deleting RDS file setosa.RDS</span></div><div class='output co'>#&gt; <span class='message'>Deleting results from id: setosa</span></div><div class='input'><span class='no'>xtractor</span>$<span class='no'>results</span></div><div class='output co'>#&gt;      Species mean_sepal_length
#&gt; 1 versicolor             5.936
#&gt; 2  virginica             6.588</div><div class='input'><span class='no'>xtractor</span>$<span class='no'>ids</span></div><div class='output co'>#&gt; [1] "versicolor" "virginica" </div><div class='input'><span class='no'>xtractor</span></div><div class='output co'>#&gt; R6 Object: Xtractor
#&gt; Name: xtractor
#&gt; Grouping variable: Species
#&gt; IDs: versicolor, virginica
#&gt; Feature functions: fun
#&gt; Extraction done: 100%
#&gt; Errors during calculation: 0 </div><div class='input'>
<span class='co'># get datasets and functions</span>
<span class='no'>fun3</span> <span class='kw'>=</span> <span class='no'>xtractor</span>$<span class='fu'>get_feature</span>(<span class='st'>"fun"</span>)
<span class='no'>df</span> <span class='kw'>=</span> <span class='no'>xtractor</span>$<span class='fu'>get_data</span>()
<span class='fu'><a href='dplyr_wrapper.html'>dplyr_wrapper</a></span>(<span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>df</span>, <span class='kw'>group_by</span> <span class='kw'>=</span> <span class='st'>"Species"</span>, <span class='kw'>fun</span> <span class='kw'>=</span> <span class='no'>fun3</span>)</div><div class='output co'>#&gt;      Species mean_sepal_length
#&gt; 1 versicolor             5.936
#&gt; 2  virginica             6.588</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Quay Au.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


