<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Function calc_feature • fxtract</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Function calc_feature">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">fxtract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Xtractor
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/xtractor_basics.html">Basics</a>
    </li>
    <li>
      <a href="../../articles/tutorial/xtractor_preprocess_data.html">Preprocess Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/xtractor_update_data.html">Update Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/xtractor_update_feature.html">Update Feature</a>
    </li>
    <li>
      <a href="../../articles/tutorial/xtractor_error_handling.html">Error Handling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/xtractor_change_backend.html">Change Backend</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/QuayAu/fxtract">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Function calc_feature</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/QuayAu/fxtract/blob/master/vignettes/tutorial/helper_calc_feature.Rmd"><code>vignettes/tutorial/helper_calc_feature.Rmd</code></a></small>
      <div class="hidden name"><code>helper_calc_feature.Rmd</code></div>

    </div>

    
    
<p>This function wraps the <code>group_by</code> functionality of <code>dplyr</code>. Given a <strong>user-defined</strong> function <code>fun</code>, <code>calc_features</code> calculates this function for each ID of a grouping variable (e.g. participants in a study). The function <code>fun</code> needs to be defined on the given dataset and is allowed to return a named vector of arbitrary length. The dataframe should contain a grouping variable with all the IDs:</p>
<p>This function works fine for small datasets and few features. But if your dataset is too big and you have many complicated features, then it’s highly advised to use the R6 object <code>Xtractor</code> (click <a href="https://quayau.github.io/fxtract/docs/articles/tutorial/basics_project.html">here</a>).</p>
<div id="example-data" class="section level2">
<h2 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h2>
<p>Let’s simulate a simple (absolutely arbitrary!) example dataset. Two participants with the ID <em>1</em> or <em>2</em> were given two tasks. For each task they were given two hours of time. A value <em>x</em> was measured during this task.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fxtract)
df =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">id =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">2</span>, <span class="dv">10</span>)))
df<span class="op">$</span>task =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"task1"</span>, <span class="dv">5</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"task2"</span>, <span class="dv">5</span>)), <span class="dv">2</span>)
df<span class="op">$</span>hour =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"hour1"</span>, <span class="dv">3</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"hour2"</span>, <span class="dv">2</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"hour1"</span>, <span class="dv">2</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="st">"hour2"</span>, <span class="dv">3</span>)), <span class="dv">2</span>)
df<span class="op">$</span>x =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Normal">rnorm</a></span>(<span class="dv">20</span>)
df</code></pre></div>
<pre><code>##    id  task  hour           x
## 1   1 task1 hour1  0.19143685
## 2   1 task1 hour1  0.80855107
## 3   1 task1 hour1  1.09426782
## 4   1 task1 hour2  1.15471186
## 5   1 task1 hour2  0.52070808
## 6   1 task2 hour1  0.15326834
## 7   1 task2 hour1  0.32424732
## 8   1 task2 hour2 -0.16014606
## 9   1 task2 hour2 -0.04448665
## 10  1 task2 hour2  1.59286235
## 11  2 task1 hour1 -0.62711501
## 12  2 task1 hour1  0.37648314
## 13  2 task1 hour1 -1.38327616
## 14  2 task1 hour2 -1.18062469
## 15  2 task1 hour2 -0.47393243
## 16  2 task2 hour1  0.59249862
## 17  2 task2 hour1  1.02390626
## 18  2 task2 hour2  0.94951160
## 19  2 task2 hour2 -0.76138792
## 20  2 task2 hour2  0.92782573</code></pre>
<div id="return-1-value-each" class="section level3">
<h3 class="hasAnchor">
<a href="#return-1-value-each" class="anchor"></a>Return 1 value each</h3>
<p>Let’s say we are interested in the maximum value of <strong>x</strong> for each participant. We need to define a function, which has a dataframe as input and a named vector as output:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fun =<span class="st"> </span><span class="cf">function</span>(data) {
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">max_x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(data<span class="op">$</span>x))
}</code></pre></div>
<p>Now we can calculate the desired outcome:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(df, <span class="dt">group_by =</span> <span class="st">"id"</span>, <span class="dt">fun =</span> fun)</code></pre></div>
<pre><code>##   id    max_x
## 1  1 1.592862
## 2  2 1.023906</code></pre>
</div>
<div id="return-more-values-at-once" class="section level3">
<h3 class="hasAnchor">
<a href="#return-more-values-at-once" class="anchor"></a>Return more values at once</h3>
<p>Sometimes calculations can take a long time (e.g. clustering of GPS points) and we want to calculate more than one value (e.g. <code>mean</code> and <code>sd</code>). This can be achieved by returning a named vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">more_features =<span class="st"> </span><span class="cf">function</span>(data) {
  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">max_x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Extremes">max</a></span>(data<span class="op">$</span>x), <span class="dt">sd_x =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(data<span class="op">$</span>x))
}
<span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(df, <span class="dt">group_by =</span> <span class="st">"id"</span>, <span class="dt">fun =</span> more_features)</code></pre></div>
<pre><code>##   id    max_x      sd_x
## 1  1 1.592862 0.5783106
## 2  2 1.023906 0.9296122</code></pre>
</div>
<div id="group-by-two-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#group-by-two-columns" class="anchor"></a>Group by two columns</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(df, <span class="dt">group_by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"id"</span>, <span class="st">"task"</span>), <span class="dt">fun =</span> more_features)</code></pre></div>
<pre><code>##   id max_x_task1 max_x_task2 sd_x_task1 sd_x_task2
## 1  1   1.1547119    1.592862  0.4031843  0.7066227
## 2  2   0.3764831    1.023906  0.6899550  0.7497385</code></pre>
</div>
<div id="group-by-three-columns" class="section level3">
<h3 class="hasAnchor">
<a href="#group-by-three-columns" class="anchor"></a>Group by three columns</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(df, <span class="dt">group_by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"id"</span>, <span class="st">"task"</span>, <span class="st">"hour"</span>), <span class="dt">fun =</span> more_features)</code></pre></div>
<pre><code>##   id max_x_task1_hour1 max_x_task1_hour2 max_x_task2_hour1
## 1  1         1.0942678         1.1547119         0.3242473
## 2  2         0.3764831        -0.4739324         1.0239063
##   max_x_task2_hour2 sd_x_task1_hour1 sd_x_task1_hour2 sd_x_task2_hour1
## 1         1.5928624        0.4614412        0.4483084        0.1209004
## 2         0.9495116        0.8827742        0.4997069        0.3050513
##   sd_x_task2_hour2
## 1        0.9804189
## 2        0.9815880</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#example-data">Example data</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Quay Au.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
