<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Studentlife • fxtract</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="Studentlife">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">fxtract</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Preprocessing Helpers
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/helpers.html">add date information</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filters.html">filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/basics_calc_feature.html">calc_feature</a>
    </li>
    <li>
      <a href="../../articles/tutorial/basics_project.html">project</a>
    </li>
    <li>
      <a href="../../articles/tutorial/basics_project_preprocess_data.html">project - preprocess data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/basics_project_update_data.html">project - update data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/basics_project_update_feature.html">project - update feature</a>
    </li>
    <li>
      <a href="../../articles/tutorial/basics_project_error_handling.html">project - error handling</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Use Cases
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/usecase_studentlife.html">StudentLife</a>
    </li>
    <li>
      <a href="../../articles/tutorial/usecase_studentlife_R6.html">StudentLife with R6</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/QuayAu/fxtract">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Studentlife</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/QuayAu/fxtract/blob/master/vignettes/tutorial/usecase_studentlife.Rmd"><code>vignettes/tutorial/usecase_studentlife.Rmd</code></a></small>
      <div class="hidden name"><code>usecase_studentlife.Rmd</code></div>

    </div>

    
    
<p>See the <a href="http://studentlife.cs.dartmouth.edu/dataset.html">official site</a> for more information on the dataset.</p>
<div id="studentlife_small" class="section level2">
<h2 class="hasAnchor">
<a href="#studentlife_small" class="anchor"></a>studentlife_small</h2>
<p>We downloaded gps and app data from three participants of the studentlife dataset.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(fxtract)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(studentlife_small)</a></code></pre></div>
<pre><code>## 'data.frame':    162154 obs. of  19 variables:
##  $ provider                           : Factor w/ 2 levels "gps","network": NA NA NA NA NA NA NA NA NA NA ...
##  $ network_type                       : chr  NA NA NA NA ...
##  $ accuracy                           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ latitude                           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ longitude                          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ altitude                           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ bearing                            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ speed                              : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ travelstate                        : Factor w/ 3 levels "","moving","stationary": NA NA NA NA NA NA NA NA NA NA ...
##  $ userId                             : chr  "00" "00" "00" "00" ...
##  $ timestamp                          : int  1364095883 1364095883 1364095883 1364095883 1364095883 1364095883 1364095883 1364095883 1364095883 1364095883 ...
##  $ device                             : chr  "1977b545-a88f-4903-a7ae-2c434de4be49" "1977b545-a88f-4903-a7ae-2c434de4be49" "1977b545-a88f-4903-a7ae-2c434de4be49" "1977b545-a88f-4903-a7ae-2c434de4be49" ...
##  $ RUNNING_TASKS_baseActivity_mClass  : chr  "org.bewellapp.dashBoardActivity" "com.android.packageinstaller.InstallAppProgress" "com.google.android.apps.chrome.Main" "com.google.android.gm.GmailActivity" ...
##  $ RUNNING_TASKS_baseActivity_mPackage: chr  "org.bewellapp" "com.android.packageinstaller" "com.android.chrome" "com.google.android.gm" ...
##  $ RUNNING_TASKS_id                   : int  249 248 245 244 2 240 241 247 243 242 ...
##  $ RUNNING_TASKS_numActivities        : int  1 1 1 1 1 1 3 4 2 1 ...
##  $ RUNNING_TASKS_numRunning           : int  1 1 1 1 1 1 3 4 2 1 ...
##  $ RUNNING_TASKS_topActivity_mClass   : chr  "org.bewellapp.dashBoardActivity" "com.android.packageinstaller.InstallAppProgress" "com.google.android.apps.chrome.Main" "com.google.android.gm.GmailActivity" ...
##  $ RUNNING_TASKS_topActivity_mPackage : chr  "org.bewellapp" "com.android.packageinstaller" "com.android.chrome" "com.google.android.gm" ...</code></pre>
<!-- # ```{r, message = FALSE, warning = FALSE} -->
<!-- # library(dplyr) -->
<!-- # studentlife_small %>% distinct(userId) -->
<!-- # ``` -->
</div>
<div id="number-of-different-used-apps" class="section level2">
<h2 class="hasAnchor">
<a href="#number-of-different-used-apps" class="anchor"></a>Number of different used apps</h2>
<p>This is a very straightforward function:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">number_diff_apps =<span class="st"> </span><span class="cf">function</span>(data) {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">number_diff_apps =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(data<span class="op">$</span>RUNNING_TASKS_topActivity_mPackage)))</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">}</a></code></pre></div>
<p>That’s all we need to calculate the number of different apps used for each participant:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">feat_data =<span class="st"> </span><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(<span class="dt">data =</span> studentlife_small, <span class="dt">fun =</span> number_diff_apps, <span class="dt">group_by =</span> <span class="st">"userId"</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">feat_data</a></code></pre></div>
<pre><code>##   userId number_diff_apps
## 1     00               93
## 2     01               43
## 3     02               72</code></pre>
<div id="number-of-different-used-apps-from-monday-until-friday" class="section level3">
<h3 class="hasAnchor">
<a href="#number-of-different-used-apps-from-monday-until-friday" class="anchor"></a>Number of different used apps from Monday until Friday</h3>
<p>For this feature, we need to filter the dataset from Monday until Friday:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">studentlife_small_weekday =<span class="st"> </span>studentlife_small <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../../reference/add_weekday.html">add_weekday</a></span>(<span class="dt">utc_col =</span> <span class="st">"timestamp"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/filter">filter</a></span>(weekday <span class="op">&gt;=</span><span class="st"> "Mon"</span> <span class="op">&amp;</span><span class="st"> </span>weekday <span class="op">&lt;=</span><span class="st"> "Fri"</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">x =<span class="st"> </span><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(<span class="dt">data =</span> studentlife_small_weekday, <span class="dt">fun =</span> number_diff_apps, <span class="dt">group_by =</span> <span class="st">"userId"</span>, <span class="dt">colname =</span> <span class="st">"number_diff_apps_weekday"</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">feat_data =<span class="st"> </span>feat_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(x)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">feat_data</a></code></pre></div>
<pre><code>##   userId number_diff_apps number_diff_apps_weekday
## 1     00               93                       91
## 2     01               43                       43
## 3     02               72                       66</code></pre>
</div>
<div id="number-of-different-used-apps-per-day" class="section level3">
<h3 class="hasAnchor">
<a href="#number-of-different-used-apps-per-day" class="anchor"></a>Number of different used apps per day</h3>
<p>To calculate this feature per day, we need to add date information to the dataset:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">studentlife_small_date =<span class="st"> </span>studentlife_small <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../../reference/add_date.html">add_date</a></span>(<span class="dt">utc_col =</span> <span class="st">"timestamp"</span>)</a></code></pre></div>
<p>Now we can calculate this feature per day:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(<span class="dt">data =</span> studentlife_small_date, <span class="dt">fun =</span> number_diff_apps, <span class="dt">group_by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"userId"</span>, <span class="st">"date"</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">x[, <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>]</a></code></pre></div>
<pre><code>##   userId X2013.03.24 X2013.03.25 X2013.03.26 X2013.03.27 X2013.03.28
## 1     00          22          21          12          20          26
## 2     01           6           5          10          18           9
## 3     02           7           3          17          28          24</code></pre>
<p>All there is left to do is to apply a mean function on the rows of this dataset. You can do this by specifying a <code>summarize</code>-function:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(<span class="dt">data =</span> studentlife_small_date, <span class="dt">fun =</span> number_diff_apps, <span class="dt">group_by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"userId"</span>, <span class="st">"date"</span>), </a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  <span class="dt">summarize =</span> <span class="cf">function</span>(x) <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(x, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">colname =</span> <span class="st">"daily_number_diff_apps"</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">feat_data =<span class="st"> </span>feat_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(x)</a></code></pre></div>
<pre><code>## Joining, by = "userId"</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">feat_data</a></code></pre></div>
<pre><code>##   userId number_diff_apps number_diff_apps_weekday daily_number_diff_apps
## 1     00               93                       91               16.86905
## 2     01               43                       43                9.60000
## 3     02               72                       66               18.14286</code></pre>
</div>
</div>
<div id="gps-features" class="section level2">
<h2 class="hasAnchor">
<a href="#gps-features" class="anchor"></a>GPS features</h2>
<div id="total-distance-covered" class="section level3">
<h3 class="hasAnchor">
<a href="#total-distance-covered" class="anchor"></a>Total distance covered</h3>
<p>Again, we need to define a function, which calculates the total distance covered by the GPS points in a given dataset <code>data</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(geosphere)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">total_dist =<span class="st"> </span><span class="cf">function</span>(data) {</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  long =<span class="st"> </span>data<span class="op">$</span>longitude</a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  lat =<span class="st"> </span>data<span class="op">$</span>latitude</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dt">total_dist =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/sum">sum</a></span>(geosphere<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/geosphere/topics/distHaversine">distHaversine</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cbind">cbind</a></span>(long, lat)), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb15-6" data-line-number="6">}</a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">x =<span class="st"> </span><span class="kw"><a href="../../reference/calc_feature.html">calc_feature</a></span>(<span class="dt">data =</span> studentlife_small, <span class="dt">group_by =</span> <span class="st">"userId"</span>, <span class="dt">fun =</span> total_dist)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">feat_data =<span class="st"> </span>feat_data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(x, <span class="dt">by =</span> <span class="st">"userId"</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">feat_data </a></code></pre></div>
<pre><code>##   userId number_diff_apps number_diff_apps_weekday daily_number_diff_apps
## 1     00               93                       91               16.86905
## 2     01               43                       43                9.60000
## 3     02               72                       66               18.14286
##   total_dist
## 1  621719.25
## 2   44649.62
## 3  108303.26</code></pre>
<p>For small projects (small datasets, few features) it’s ok to calculate the features like above and join the resulting dataframes with <code><a href="https://dplyr.tidyverse.org/reference/join.html">dplyr::left_join</a></code> (or your preferred method). But it becomes very burdensome, if datasets get too big for memory and features (possibly many different ones) must be calculated in chunks and be joined afterwards. We made the experience that single errors (e.g. one feature throws an error on one participant) can stop the whole process. Updating this feature and calculate it again can be quite convoluted because of loops and code bloat (many joins). For larger projects use the R6 class <code>Project</code>. A use case can be found <a href="https://quayau.github.io/fxtract/docs/articles/tutorial/usecase_studentlife_R6.html">here</a>.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#studentlife_small">studentlife_small</a></li>
      <li><a href="#number-of-different-used-apps">Number of different used apps</a></li>
      <li><a href="#gps-features">GPS features</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Quay Au, Theresa Ullmann.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
